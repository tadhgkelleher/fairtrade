<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fair Trade Coffee Connections</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet">
  <style>
    #connections-graph-container {
      position: relative;
      background-color: #2C1810;
      margin: 0 auto;
      width: 100%;
      padding: 10px;
      display: flex;
      flex-direction: column;
      align-items: center;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    #connections-graph {
      height: 800px;
      width: 100%;
    }

    .toggle-physics-button {
      background-color: #8B4513;
      color: #F5DEB3;
      padding: 12px 24px;
      border: none;
      border-radius: 4px;
      font-size: 18px;
      margin: 0 auto;
      cursor: pointer;
      text-align: center;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
      position: sticky;
      top: 10px;
      z-index: 9999;
      transition: background-color 0.3s ease;
    }

    .toggle-physics-button:hover {
      background-color: #A0522D;
    }
  </style>
</head>
<body>

<div id="connections-graph-container">
  <button class="toggle-physics-button">Enable Physics</button>
  <div id="connections-graph"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const items = [
      { id: 1, title: "Colombian Cooperative", tags: ["Fair Trade", "Organic", "Direct Trade", "Climate Action"] },
      { id: 2, title: "Ethiopian Union", tags: ["Fair Trade", "Women Owned", "Education", "Heritage"] },
      { id: 3, title: "Local Roastery", tags: ["Artisan", "Zero Waste", "Local", "Training"] },
      { id: 4, title: "Research Institute", tags: ["Innovation", "Education", "Climate Action", "Biodiversity"] },
      { id: 5, title: "CafÃ© Chain", tags: ["Direct Trade", "Local", "Zero Waste", "Training"] },
      { id: 6, title: "NGO Partner", tags: ["Community", "Education", "Women Owned", "Healthcare"] },
      { id: 7, title: "Guatemala Farmers", tags: ["Fair Trade", "Indigenous", "Heritage", "Organic"] },
      { id: 8, title: "Vietnam Collective", tags: ["Direct Trade", "Innovation", "Export", "Training"] },
      { id: 9, title: "Urban Network", tags: ["Zero Waste", "Local", "Youth", "Community"] },
      { id: 10, title: "Green Institute", tags: ["Climate Action", "Research", "Biodiversity", "Education"] },
      { id: 11, title: "Tech Startup", tags: ["Innovation", "Blockchain", "Export", "Training"] },
      { id: 12, title: "Rural Fund", tags: ["Microfinance", "Community", "Women Owned", "Healthcare"] },
      { id: 13, title: "Kenya Farmers", tags: ["Fair Trade", "Indigenous", "Heritage", "Export"] },
      { id: 14, title: "Eco Packaging", tags: ["Zero Waste", "Innovation", "Local", "Climate Action"] },
      { id: 15, title: "Quality Lab", tags: ["Research", "Training", "Export", "Innovation"] },
      { id: 16, title: "Mexico Growers", tags: ["Fair Trade", "Indigenous", "Organic", "Community"] },
      { id: 17, title: "Peru Alliance", tags: ["Heritage", "Biodiversity", "Fair Trade", "Women Owned"] },
      { id: 18, title: "Japan Importers", tags: ["Direct Trade", "Quality", "Export", "Innovation"] },
      { id: 19, title: "Nordic Roasters", tags: ["Artisan", "Climate Action", "Zero Waste", "Training"] },
      { id: 20, title: "Youth Program", tags: ["Education", "Community", "Training", "Local"] },
      { id: 21, title: "India Collective", tags: ["Fair Trade", "Women Owned", "Organic", "Heritage"] },
      { id: 22, title: "Brazil Network", tags: ["Export", "Innovation", "Research", "Training"] },
      { id: 23, title: "US Distributors", tags: ["Local", "Zero Waste", "Direct Trade", "Quality"] },
      { id: 24, title: "Africa Fund", tags: ["Microfinance", "Healthcare", "Education", "Community"] },
      { id: 25, title: "Climate Alliance", tags: ["Climate Action", "Research", "Biodiversity", "Innovation"] }
    ];

    const nodes = new vis.DataSet([]);
    const edges = new vis.DataSet([]);
    const nodeConnections = {};

    items.forEach(item => {
      const itemNode = {
        id: item.id,
        label: item.title,
        title: `<h3>${item.title}</h3><ul>${item.tags.map(tag => `<li>${tag}</li>`).join('')}</ul>`,
        group: "item",
        size: item.tags.length * 5,
        color: {
          background: '#1E90FF',
          border: '#4682B4',
          highlight: {
            background: '#87CEFA',
            border: '#5F9EA0'
          }
        }
      };
      nodes.add(itemNode);

      item.tags.forEach(tag => {
        const tagNode = nodes.get(tag);
        if (!tagNode) {
          nodes.add({ 
            id: tag, 
            label: tag, 
            group: "tag", 
            size: 10,
            color: {
              background: '#32CD32',
              border: '#228B22',
              highlight: {
                background: '#98FB98',
                border: '#006400'
              }
            }
          });
        }

        edges.add({ 
          from: item.id, 
          to: tag,
          color: {
            color: '#FFD700',
            highlight: '#FF8C00'
          }
        });

        nodeConnections[tag] = (nodeConnections[tag] || 0) + 1;
        nodeConnections[item.id] = (nodeConnections[item.id] || 0) + 1;
      });
    });

    nodes.forEach(node => {
      const connectionCount = nodeConnections[node.id] || 0;
      node.size = connectionCount * 3;
      nodes.update(node);
    });

    const container = document.getElementById("connections-graph");
    const data = { nodes: nodes, edges: edges };
    const options = {
      nodes: {
        shape: 'dot',
        font: { 
          size: 14,
          color: '#F5DEB3'
        },
      },
      edges: {
        width: 2,
        smooth: {
          type: 'continuous'
        }
      },
      physics: {
        enabled: false,
        solver: 'forceAtlas2Based',
        forceAtlas2Based: {
          gravitationalConstant: -500,
          centralGravity: 0.005,
          springLength: 200,
          springConstant: 0.04,
          damping: 0.4,
          avoidOverlap: 0.5
        }
      },
      interaction: {
        hover: true,
        zoomView: true,
        dragView: true,
        zoomSpeed: 0.5,
        initialScale: 0.2,
      },
      layout: {
        randomSeed: 2,
        hierarchical: false,
        improvedLayout: false,
        circular: true
      }
    };

    const network = new vis.Network(container, data, options);

    network.moveTo({
      position: { x: 0, y: 0 },
      scale: .3,
    });

    const toggleButton = document.querySelector(".toggle-physics-button");
    let physicsEnabled = false;
    let currentLayout = "circular";

    toggleButton.addEventListener("click", function () {
      physicsEnabled = !physicsEnabled;
      options.physics.enabled = physicsEnabled;
      if (currentLayout === "circular") {
        options.layout.randomSeed = 2;
        options.layout.circular = false;
        currentLayout = "random";
      } else {
        options.layout.randomSeed = 2;
        options.layout.circular = true;
        currentLayout = "circular";
      }
      network.setOptions(options);
      toggleButton.textContent = physicsEnabled ? "Disable Physics" : "Enable Physics";
    });
  });
</script>

</body>
</html>
